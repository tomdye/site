{"value":{"body":"[{\"id\":11517,\"date\":\"2016-04-19T07:21:20\",\"date_gmt\":\"2016-04-19T14:21:20\",\"guid\":{\"rendered\":\"https://www.sitepen.com/blog/?p=11517\"},\"modified\":\"2016-04-19T07:21:20\",\"modified_gmt\":\"2016-04-19T14:21:20\",\"slug\":\"command-helpers\",\"status\":\"publish\",\"type\":\"post\",\"link\":\"https://wp.sitepen.com/blog/command-helpers/\",\"title\":{\"rendered\":\"Simplifying Intern tests with Command helpers\"},\"content\":{\"rendered\":\"<p><img src=\\\"https://wp.sitepen.com/wp-content/uploads/2016/04/leadfoot_heading.png\\\" width=\\\"620px\\\" alt=\\\"Intern Logo\\\" /></p>\\n<p>Intern, via the <a href=\\\"https://theintern.github.io/leadfoot\\\">Leadfoot</a> WebDriver library, provides a lot of low-level control over the browsers it uses to run tests. Tests can navigate to new pages, resize the browser window, examine elements on a page, and interact with controls like inputs and buttons. Unfortunately, with all this power can come great complexity. Many testing tasks will involve a large number of low-level operations and dealing with these can be error prone and make tests difficult to follow. Command helpers to the rescue!</p>\\n<p><!--more--></p>\\n<h3>What&#8217;s a Command helper?</h3>\\n<p>The term &#8220;Command helper&#8221; refers to a design pattern for creating reusable modules for Intern functional tests. They&#8217;re called Command helpers because they&#8217;re built around Leadfoot <a href=\\\"https://theintern.github.io/leadfoot/module-leadfoot_Command.html\\\">Command</a> objects (e.g., <code>this.remote</code> in a functional test). The idea is to create functions that execute groups of low-level commands for some higher-level purpose. For example, assume a login form is used by several different applications being tested. The commands in a functional test to fill in and submit the login form, and to verify that the login was successful, might look like the following:</p>\\n<pre class=\\\"brush: jscript; title: ; notranslate\\\" title=\\\"\\\">\\nreturn this.remote\\n    .get('page.html')\\n\\n\\t.findById('username')\\n\\t.type('foo')\\n\\t.end()\\n\\n\\t.findById('password')\\n\\t.type('bar')\\n\\t.end\\n\\n\\t.findById('submit')\\n\\t.click()\\n\\t.end()\\n\\n\\t.findByTag('h1')\\n\\t.getVisibleText()\\n\\t.then(function (text) {\\n\\t    assert.equal(text, 'Welcome, foo!');\\n\\t})\\n</pre>\\n<p>We can dramatically simplify the above example by moving the low-level logic into Command helpers.</p>\\n<pre class=\\\"brush: jscript; title: ; notranslate\\\" title=\\\"\\\">\\nreturn this.remote\\n    .get('page.html')\\n\\t.then(login('foo', 'bar'))\\n\\t.then(verifyLogin('foo'));\\n</pre>\\n<p>Not only is this code easier to read, but the helper functions allow the login and verification logic to be shared with other test suites.</p>\\n<h3>Writing Command helpers</h3>\\n<p>So, what does a Command helper look like? In general, a Command helper is implemented as a function that returns a function that can be passed to a <code>then</code> call in a Leadfoot Command chain:</p>\\n<pre class=\\\"brush: jscript; title: ; notranslate\\\" title=\\\"\\\">\\nfunction helper() {\\n    return function () { /* helper code */ }\\n}\\n\\nregisterSuite({\\n    test1: function () {\\n        return this.remote\\n            .get('page.html')\\n            .then(helper())\\n    }\\n});\\n</pre>\\n<p>To get a better sense of how this works, consider how the first code snippet in the previous section might be transformed into the second using Command helpers. First, we can rewrite the code so that related function calls are grouped into <code>then</code> callbacks:</p>\\n<pre class=\\\"brush: jscript; title: ; notranslate\\\" title=\\\"\\\">\\nreturn this.remote\\n    .get('page.html')\\n\\n\\t// Code to perform login action\\n\\t.then(function () {\\n\\t    return this.parent\\n\\t\\t\\t.findById('username')\\n\\t\\t\\t.type('foo')\\n\\t\\t\\t.end()\\n\\n\\t\\t\\t.findById('password')\\n\\t\\t\\t.type('bar')\\n\\t\\t\\t.end\\n\\n\\t\\t\\t.findById('submit')\\n\\t\\t\\t.click();\\n\\t})\\n\\n\\t// Code to check that the login was successful\\n\\t.then(function () {\\n\\t\\treturn this.parent\\n\\t\\t\\t.findByTag('h1')\\n\\t\\t\\t.getVisibleText()\\n\\t\\t\\t.then(function (text) {\\n\\t\\t\\t\\tassert.equal(text, 'Welcome, foo!');\\n\\t\\t\\t});\\n\\t})\\n</pre>\\n<p>A few details should be noted:</p>\\n<ul>\\n<li>The Command chain is built from <code>this.parent</code> rather than a reference to <code>this.remote</code>. This allows the helper to execute in the context of the outer Command chain (the one that called the helper). For example, if the context of the outer Command chain was a particular &lt;table&gt; element on the page, that will be the context of <code>this.parent</code> in the Command chain.</li>\\n<li>While the search context for the <code>this.parent</code> Command chain is initially the same as the context parent chain&#8217;s context, changes to the <code>this.parent</code> chain&#8217;s context will not affect the parent. This means you don&#8217;t need to worry about restoring the search context (by calling <code>end()</code>) at the end of the <code>then</code> callback.</li>\\n<li>The Command chain must be returned by the <code>then</code> callback or the parent Command chain won&#8217;t wait for the actions in the <code>then</code> callback to complete.</li>\\n</ul>\\n<p>Next, the code in those callbacks can be moved into separate functions. To keep the functions generic, the username and password can be passed in as configuration parameters. Through the magic of JavaScript closures, the functions that will actually be used as <code>then</code> callbacks (the ones returned by the helper functions) will have access to the configuration parameters when they&#8217;re called.</p>\\n<pre class=\\\"brush: jscript; title: ; notranslate\\\" title=\\\"\\\">\\nfunction login(username, password) {\\n\\treturn function () {\\n\\t    return this.parent\\n\\t\\t\\t.findById('username')\\n\\t\\t\\t.type(username)\\n\\t\\t\\t.end()\\n\\n\\t\\t\\t.findById('password')\\n\\t\\t\\t.type(password)\\n\\t\\t\\t.end\\n\\n\\t\\t\\t.findById('submit')\\n\\t\\t\\t.click();\\n\\t}\\n}\\n\\nfunction verifyLogin(username) {\\n\\treturn function () {\\n\\t\\treturn this.parent\\n\\t\\t\\t.findByTag('h1')\\n\\t\\t\\t.getVisibleText()\\n\\t\\t\\t.then(function (text) {\\n\\t\\t\\t\\tassert.equal(text, 'Welcome, ' + username + '!');\\n\\t\\t\\t});\\n\\t}\\n};\\n\\nregisterSuite({\\n    test1: function () {\\n        return this.remote\\n            .get('page.html')\\n            .then(login('foo', 'bar'))\\n            .then(verifyLogin('foo'));\\n    }\\n});\\n</pre>\\n<p>These examples show only the most basic application of Command helpers. Helpers can be created for much more complex tasks, and can even be grouped into higher-level abstractions such as <a href=\\\"https://theintern.github.io/intern/#page-objects\\\">Page Objects</a>. And Dojo users can leverage our <a href=\\\"https://www.sitepen.com/blog/2016/01/13/simplified-dijit-functional-testing/\\\">Dijit helper</a> for testing their widgets efficiently. Command helpers are a great example of how Intern makes it easy to write compact and maintainable functional tests!</p>\\n<p><img src=\\\"https://wp.sitepen.com/wp-content/uploads/2015/06/ogJSSupport1.png\\\" alt=\\\"Enterprise JavaScript Support\\\" /></p>\\n<h3>Learning more</h3>\\n<p>We cover the creation of functional tests, including writing Command helpers, in our <a href=\\\"https://www.sitepen.com/workshops/\\\">Intern and Dojo 202 workshops</a>, and we <a href=\\\"https://www.sitepen.com/services/\\\">support developers worldwide in their efforts with JavaScript and testing</a>. If you would like to discuss how we can help your organization improve their approach to automated testing, please <a href=\\\"https://www.sitepen.com/contact/\\\">contact us</a> to start the conversation.</p>\\n\",\"protected\":false},\"excerpt\":{\"rendered\":\"<p>Intern, via the Leadfoot WebDriver library, provides a lot of low-level control over the browsers it uses to run tests. Tests can navigate to new pages, resize the browser window, examine elements on a page, and interact with controls like inputs and buttons. Unfortunately, with all this power can come great complexity. Many testing tasks [&hellip;]</p>\\n\",\"protected\":false},\"author\":51,\"featured_media\":12083,\"comment_status\":\"closed\",\"ping_status\":\"closed\",\"sticky\":false,\"template\":\"\",\"format\":\"standard\",\"meta\":{\"spay_email\":\"\"},\"categories\":[45,375,3],\"tags\":[388,421,5,140],\"series\":[],\"jetpack_featured_media_url\":\"\",\"yoast_head\":\"<!-- This site is optimized with the Yoast SEO plugin v14.7 - https://yoast.com/wordpress/plugins/seo/ -->\\n<title>Simplifying Intern tests with Command helpers | SitePen</title>\\n<meta name=\\\"description\\\" content=\\\"Intern, via the Leadfoot WebDriver library, provides a lot of low-level control over the browsers it uses to run tests. Tests can navigate to new pages, resize the browser window, examine elements on a page, and interact with controls like inputs and buttons. Unfortunately, with all this power can come great complexity. M\\\" />\\n<meta name=\\\"robots\\\" content=\\\"index, follow\\\" />\\n<meta name=\\\"googlebot\\\" content=\\\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\\\" />\\n<meta name=\\\"bingbot\\\" content=\\\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\\\" />\\n<link rel=\\\"canonical\\\" href=\\\"https://www.sitepen.com/blog/command-helpers/\\\" />\\n<meta property=\\\"og:locale\\\" content=\\\"en_US\\\" />\\n<meta property=\\\"og:type\\\" content=\\\"article\\\" />\\n<meta property=\\\"og:title\\\" content=\\\"Simplifying Intern tests with Command helpers | SitePen\\\" />\\n<meta property=\\\"og:description\\\" content=\\\"Intern, via the Leadfoot WebDriver library, provides a lot of low-level control over the browsers it uses to run tests. Tests can navigate to new pages, resize the browser window, examine elements on a page, and interact with controls like inputs and buttons. Unfortunately, with all this power can come great complexity. M\\\" />\\n<meta property=\\\"og:url\\\" content=\\\"https://www.sitepen.com/blog/command-helpers/\\\" />\\n<meta property=\\\"og:site_name\\\" content=\\\"SitePen\\\" />\\n<meta property=\\\"article:publisher\\\" content=\\\"https://www.facebook.com/SitePen\\\" />\\n<meta property=\\\"article:published_time\\\" content=\\\"2016-04-19T14:21:20+00:00\\\" />\\n<meta property=\\\"og:image\\\" content=\\\"https://wp.sitepen.com/wp-content/uploads/2020/01/og_imageV1.jpg\\\" />\\n\\t<meta property=\\\"og:image:width\\\" content=\\\"1600\\\" />\\n\\t<meta property=\\\"og:image:height\\\" content=\\\"900\\\" />\\n<meta name=\\\"twitter:card\\\" content=\\\"summary_large_image\\\" />\\n<meta name=\\\"twitter:creator\\\" content=\\\"@SitePen\\\" />\\n<meta name=\\\"twitter:site\\\" content=\\\"@SitePen\\\" />\\n<script type=\\\"application/ld+json\\\" class=\\\"yoast-schema-graph\\\">{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@graph\\\":[{\\\"@type\\\":\\\"WebSite\\\",\\\"@id\\\":\\\"https://wp.sitepen.com/#website\\\",\\\"url\\\":\\\"https://wp.sitepen.com/\\\",\\\"name\\\":\\\"SitePen\\\",\\\"description\\\":\\\"Enterprise Web Apps Done Right\\\",\\\"potentialAction\\\":[{\\\"@type\\\":\\\"SearchAction\\\",\\\"target\\\":\\\"https://wp.sitepen.com/?s={search_term_string}\\\",\\\"query-input\\\":\\\"required name=search_term_string\\\"}],\\\"inLanguage\\\":\\\"en-US\\\"},{\\\"@type\\\":\\\"ImageObject\\\",\\\"@id\\\":\\\"https://www.sitepen.com/blog/command-helpers/#primaryimage\\\",\\\"inLanguage\\\":\\\"en-US\\\",\\\"url\\\":\\\"\\\"},{\\\"@type\\\":\\\"WebPage\\\",\\\"@id\\\":\\\"https://www.sitepen.com/blog/command-helpers/#webpage\\\",\\\"url\\\":\\\"https://www.sitepen.com/blog/command-helpers/\\\",\\\"name\\\":\\\"Simplifying Intern tests with Command helpers | SitePen\\\",\\\"isPartOf\\\":{\\\"@id\\\":\\\"https://wp.sitepen.com/#website\\\"},\\\"primaryImageOfPage\\\":{\\\"@id\\\":\\\"https://www.sitepen.com/blog/command-helpers/#primaryimage\\\"},\\\"datePublished\\\":\\\"2016-04-19T14:21:20+00:00\\\",\\\"dateModified\\\":\\\"2016-04-19T14:21:20+00:00\\\",\\\"author\\\":{\\\"@id\\\":\\\"https://wp.sitepen.com/#/schema/person/c6c5a850ef09b6170f40dc435057d591\\\"},\\\"description\\\":\\\"Intern, via the Leadfoot WebDriver library, provides a lot of low-level control over the browsers it uses to run tests. Tests can navigate to new pages, resize the browser window, examine elements on a page, and interact with controls like inputs and buttons. Unfortunately, with all this power can come great complexity. M\\\",\\\"inLanguage\\\":\\\"en-US\\\",\\\"potentialAction\\\":[{\\\"@type\\\":\\\"ReadAction\\\",\\\"target\\\":[\\\"https://www.sitepen.com/blog/command-helpers/\\\"]}]},{\\\"@type\\\":[\\\"Person\\\"],\\\"@id\\\":\\\"https://wp.sitepen.com/#/schema/person/c6c5a850ef09b6170f40dc435057d591\\\",\\\"name\\\":\\\"Jason Cheatham\\\",\\\"image\\\":{\\\"@type\\\":\\\"ImageObject\\\",\\\"@id\\\":\\\"https://wp.sitepen.com/#personlogo\\\",\\\"inLanguage\\\":\\\"en-US\\\",\\\"url\\\":\\\"https://secure.gravatar.com/avatar/27ad4194c35370123fd3544be84199c6?s=96&d=mm&r=g\\\",\\\"caption\\\":\\\"Jason Cheatham\\\"}}]}</script>\\n<!-- / Yoast SEO plugin. -->\",\"_links\":{\"self\":[{\"href\":\"https://wp.sitepen.com/wp-json/wp/v2/posts/11517\"}],\"collection\":[{\"href\":\"https://wp.sitepen.com/wp-json/wp/v2/posts\"}],\"about\":[{\"href\":\"https://wp.sitepen.com/wp-json/wp/v2/types/post\"}],\"author\":[{\"embeddable\":true,\"href\":\"https://wp.sitepen.com/wp-json/wp/v2/users/51\"}],\"replies\":[{\"embeddable\":true,\"href\":\"https://wp.sitepen.com/wp-json/wp/v2/comments?post=11517\"}],\"version-history\":[{\"count\":0,\"href\":\"https://wp.sitepen.com/wp-json/wp/v2/posts/11517/revisions\"}],\"wp:featuredmedia\":[{\"embeddable\":true,\"href\":\"https://wp.sitepen.com/wp-json/wp/v2/media/12083\"}],\"wp:attachment\":[{\"href\":\"https://wp.sitepen.com/wp-json/wp/v2/media?parent=11517\"}],\"wp:term\":[{\"taxonomy\":\"category\",\"embeddable\":true,\"href\":\"https://wp.sitepen.com/wp-json/wp/v2/categories?post=11517\"},{\"taxonomy\":\"post_tag\",\"embeddable\":true,\"href\":\"https://wp.sitepen.com/wp-json/wp/v2/tags?post=11517\"},{\"taxonomy\":\"series\",\"embeddable\":true,\"href\":\"https://wp.sitepen.com/wp-json/wp/v2/series?post=11517\"}],\"curies\":[{\"name\":\"wp\",\"href\":\"https://api.w.org/{rel}\",\"templated\":true}]},\"_embedded\":{\"author\":[{\"id\":51,\"name\":\"Jason Cheatham\",\"url\":\"\",\"description\":\"\",\"link\":\"https://wp.sitepen.com/blog/author/jcheatham/\",\"slug\":\"jcheatham\",\"avatar_urls\":{\"24\":\"https://secure.gravatar.com/avatar/27ad4194c35370123fd3544be84199c6?s=24&d=mm&r=g\",\"48\":\"https://secure.gravatar.com/avatar/27ad4194c35370123fd3544be84199c6?s=48&d=mm&r=g\",\"96\":\"https://secure.gravatar.com/avatar/27ad4194c35370123fd3544be84199c6?s=96&d=mm&r=g\"},\"yoast_head\":\"<!-- This site is optimized with the Yoast SEO plugin v14.7 - https://yoast.com/wordpress/plugins/seo/ -->\\n<title>Jason Cheatham, Author at SitePen</title>\\n<meta name=\\\"robots\\\" content=\\\"noindex, follow\\\" />\\n<meta property=\\\"og:locale\\\" content=\\\"en_US\\\" />\\n<meta property=\\\"og:type\\\" content=\\\"profile\\\" />\\n<meta property=\\\"og:title\\\" content=\\\"Jason Cheatham, Author at SitePen\\\" />\\n<meta property=\\\"og:url\\\" content=\\\"https://www.sitepen.com/blog/author/jcheatham/\\\" />\\n<meta property=\\\"og:site_name\\\" content=\\\"SitePen\\\" />\\n<meta property=\\\"og:image\\\" content=\\\"https://secure.gravatar.com/avatar/27ad4194c35370123fd3544be84199c6?s=500&#038;d=mm&#038;r=g\\\" />\\n<meta name=\\\"twitter:card\\\" content=\\\"summary_large_image\\\" />\\n<meta name=\\\"twitter:site\\\" content=\\\"@SitePen\\\" />\\n<script type=\\\"application/ld+json\\\" class=\\\"yoast-schema-graph\\\">{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@graph\\\":[{\\\"@type\\\":\\\"WebSite\\\",\\\"@id\\\":\\\"https://wp.sitepen.com/#website\\\",\\\"url\\\":\\\"https://wp.sitepen.com/\\\",\\\"name\\\":\\\"SitePen\\\",\\\"description\\\":\\\"Enterprise Web Apps Done Right\\\",\\\"potentialAction\\\":[{\\\"@type\\\":\\\"SearchAction\\\",\\\"target\\\":\\\"https://wp.sitepen.com/?s={search_term_string}\\\",\\\"query-input\\\":\\\"required name=search_term_string\\\"}],\\\"inLanguage\\\":\\\"en-US\\\"},{\\\"@type\\\":\\\"ProfilePage\\\",\\\"@id\\\":\\\"https://www.sitepen.com/blog/author/jcheatham/#webpage\\\",\\\"url\\\":\\\"https://www.sitepen.com/blog/author/jcheatham/\\\",\\\"name\\\":\\\"Jason Cheatham, Author at SitePen\\\",\\\"isPartOf\\\":{\\\"@id\\\":\\\"https://wp.sitepen.com/#website\\\"},\\\"inLanguage\\\":\\\"en-US\\\"},{\\\"@type\\\":[\\\"Person\\\"],\\\"@id\\\":\\\"https://wp.sitepen.com/#/schema/person/c6c5a850ef09b6170f40dc435057d591\\\",\\\"name\\\":\\\"Jason Cheatham\\\",\\\"image\\\":{\\\"@type\\\":\\\"ImageObject\\\",\\\"@id\\\":\\\"https://wp.sitepen.com/#personlogo\\\",\\\"inLanguage\\\":\\\"en-US\\\",\\\"url\\\":\\\"https://secure.gravatar.com/avatar/27ad4194c35370123fd3544be84199c6?s=96&d=mm&r=g\\\",\\\"caption\\\":\\\"Jason Cheatham\\\"},\\\"mainEntityOfPage\\\":{\\\"@id\\\":\\\"https://www.sitepen.com/blog/author/jcheatham/#webpage\\\"}}]}</script>\\n<!-- / Yoast SEO plugin. -->\",\"_links\":{\"self\":[{\"href\":\"https://wp.sitepen.com/wp-json/wp/v2/users/51\"}],\"collection\":[{\"href\":\"https://wp.sitepen.com/wp-json/wp/v2/users\"}]}}],\"wp:featuredmedia\":[{\"code\":\"rest_post_invalid_id\",\"message\":\"Invalid post ID.\",\"data\":{\"status\":404}}]}}]","headers":[["access-control-allow-headers","Authorization, Content-Type"],["access-control-expose-headers","X-WP-Total, X-WP-TotalPages"],["allow","GET"],["cache-control","max-age=2592000"],["connection","close"],["content-type","application/json; charset=UTF-8"],["date","Mon, 10 Aug 2020 15:31:03 GMT"],["expires","Wed, 09 Sep 2020 15:31:03 GMT"],["link","<https://wp.sitepen.com/wp-json/>; rel=\"https://api.w.org/\""],["server","Apache"],["transfer-encoding","chunked"],["vary","Origin"],["x-content-type-options","nosniff"],["x-powered-by","PHP/7.3.21-1+0~20200807.66+debian9~1.gbp18a1c2"],["x-robots-tag","noindex"],["x-wp-total","1"],["x-wp-totalpages","1"]]},"type":"Object"}